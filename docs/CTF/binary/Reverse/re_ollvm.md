## Article
[示例 xnuca-Strange Interpreter-浅谈逆向小技巧](https://xz.aliyun.com/t/3464)

[记一次基于unidbg模拟执行的去除ollvm混淆](https://mp.weixin.qq.com/s/KuWi39Grl9lrhI8iY_S8pw)

[ollvm总结](http://s0rry.cn/archives/2023-02-26-07-22-37)
[虚假控制流入门：Ubuntu20.04安装ollvm4.0踩坑记+用IDApython去除BCF](https://www.52pojie.cn/thread-1692596-1-1.html)
[利用angr符号执行去除控制流平坦化](https://bluesadi.github.io/0x401RevTrain-Tools/angr/10_利用angr符号执行去除控制流平坦化/)
[CTF逆向-[SUCTF2019]hardcpp](https://blog.csdn.net/m0_37157335/article/details/124505286)
[ollvm 学习笔记](https://blog.csdn.net/qq_45323960/article/details/124440184)
[利用unicron去除ollvm混淆](https://www.cnblogs.com/revercc/p/16339476.html)
[Unicorn反混淆：恢复被OLLVM保护的程序(一)](https://blog.51cto.com/u_15527932/5218378)
[你所需要的对抗ollvm的知识都在这里](https://bbs.pediy.com/thread-272414.htm) 
[Android OLLVM反混淆实战](https://blog.csdn.net/zhangmiaoping23/article/details/117220177)
[利用angr符号执行去除虚假控制流](https://bbs.pediy.com/thread-266005.htm) 
[利用符号执行去除控制流平坦化](https://security.tencent.com/index.php/blog/msg/112)
[利用angr还原ollvm指令流平坦化](https://github.com/pcy190/deflat)
[android逆向奇技淫巧十：OLLVM原理、常见破解思路和hook代码](https://www.cnblogs.com/theseventhson/p/14861940.html)
[OLLVM控制流平坦化的改进 ](https://bbs.pediy.com/thread-274778.htm)
[MRCTF2022 llvmvm出题以及解题](https://bbs.pediy.com/user-home-948449.htm)
[2022祥云杯CTF babyparser ](https://bbs.pediy.com/thread-275296.htm)
[三叶草小组Syclover | 浅谈虚拟机保护还原](https://www.bilibili.com/video/BV1oP4y1X7oz/) 
[frida辅助分析ollvm](https://bbs.pediy.com/thread-275265.htm) 
[从开发的角度看看ollvm](https://bbs.pediy.com/thread-274996.htm) 
[OLLVM-deflat 脚本学习](https://mp.weixin.qq.com/s/3ZiBPRK4NcOR_o4gnjO8GQ)

看雪
[ollvm分析及反混淆](https://mp.weixin.qq.com/s/ih-ysrNUkxFVXCeaUIcMkQ)
[p.z【ACTF2022】Inflated（C++异常处理控制流下的OLLVM混淆） ](https://bbs.pediy.com/thread-273764.htm)
[『直播中』从unidbg trace log中还原被ollvm混淆的非标准算法](https://mp.weixin.qq.com/s/LZyDuCKIrH4bQQZgoNuvCA)
[大杀器Unidbg真正的威力](https://mp.weixin.qq.com/s/eJef9L3WA_8neQw-gGAGrg)
[使用unidbg还原标准ollvm的fla控制流程平坦化 ](https://bbs.pediy.com/thread-267687.htm) 
[使用unidbg去ollvm虚假分支反混淆 ](https://bbs.pediy.com/thread-267499.htm) 
[使用ollvm自定义简单的字符串加密 ](https://bbs.pediy.com/thread-264497.htm) 
[使用unicorn来trace还原ollvm混淆的非标准算法 ](https://bbs.pediy.com/thread-264498.htm) 
[2w班8月份第二题hook init_array中函数解密ollvm加密字符串](https://bbs.pediy.com/thread-264405.htm) 
[对ollvm的算法进行逆向分析和还原 ](https://bbs.pediy.com/thread-270529.htm) 
[记使用Trace还原ollvm混淆的函数 #30天写作挑战# ](https://bbs.pediy.com/thread-261773.htm) 
[ ollvm CrackMe算法分析 ](https://bbs.pediy.com/thread-258585.htm) 
[使用Binary Ninja去除ollvm流程平坦混淆 ](https://bbs.pediy.com/thread-256299.htm) 
[使用IDA trace来还原ollvm混淆的非标准算法](https://bbs.pediy.com/thread-264981.htm)
[使用unicorn来trace还原ollvm混淆的非标准算法 ](https://bbs.pediy.com/thread-264498.htm) 
[一道简单的ollvm算法题还原 ](https://bbs.pediy.com/thread-268258.htm) 
[ollvm算法还原案例分享 看雪3W班5月题](https://bbs.pediy.com/thread-260655.htm) 
[ollvm算法还原案例分享 8月ollvm题](https://bbs.pediy.com/thread-263211.htm) 
[ollvm算法还原案例分享 看雪3W班12月ollvm](https://mp.weixin.qq.com/s/lCH_4CzfvLWLVpUJpGl7Xw)
[LLVM字符串加密学习笔记](https://mp.weixin.qq.com/s/uH_kvrv3PYHyIuQC80BUsg)

[基于Unicorn 的ARM64 OLLVM反混淆](https://bbs.pediy.com/thread-252321.htm) 
[细说arm反类ollvm混淆-基本思想 ](https://bbs.pediy.com/thread-257878.htm) 
[对ollvm的算法进行逆向分析和还原 ](https://bbs.pediy.com/thread-270529.htm) 
[OLLVM虚假控制流源码学习笔记](https://bbs.pediy.com/thread-266201.htm) 
[ollvm算法还原案例分享 安卓高研3w班（8月班）](https://mp.weixin.qq.com/s/tbWaCy41kVSegGd6Sqi3EA)
[浅尝ollvm轻度混淆后的加密算法分析](https://mp.weixin.qq.com/s/f_faZEZo9qxwRxkF2qiA9A)
[ollvm反混淆学习](https://mp.weixin.qq.com/s/4Wyyaa14CHWyKhqLPPIsqw)

[Here-is-SG | LLVM学习笔记](https://www.cnblogs.com/Here-is-SG/p/16708170.html)
[Here-is-SG | llvm - 基本块分割](https://www.cnblogs.com/Here-is-SG/p/16744957.html)
[Here-is-SG | 初探代码混淆](https://www.cnblogs.com/Here-is-SG/p/16813913.html)

- [LLVM Pass PWN（上）](http://mp.weixin.qq.com/s?__biz=MzUzMDUxNTE1Mw==&mid=2247496124&idx=1&sn=af2d0a9f7d60e6903423a7ca64bd76a5)
- [LLVM Pass PWN（下）](http://mp.weixin.qq.com/s?__biz=MzUzMDUxNTE1Mw==&mid=2247496199&idx=1&sn=17cf42f584ca910302bd2c46f9fe4757)

字符串
[字符串混淆 | 2020-06-05-Frida辅助分析OLLVM混淆的算法](https://huhu0706.github.io/2020/06/05/2020-06-05-Frida%E8%BE%85%E5%8A%A9%E5%88%86%E6%9E%90OLLVM%E6%B7%B7%E6%B7%86%E7%9A%84%E7%AE%97%E6%B3%95/)
[字符串混淆 | AndroidNativeEmu和unidbg对抗ollvm的字符串混淆](http://www.yxfzedu.com/rs_show/1211)
[字符串混淆 | 某右 so层ollvm字符串混淆 libnet_crypto.so](https://bbs.pediy.com/thread-266583.htm)
[字符串混淆 | [原创]使用unicorn对ollvm字符串进行解密 ](https://bbs.pediy.com/thread-268108.htm)
[字符串加密 | Unicorn实战（二）：去掉armariris的字符串加密](https://www.leadroyal.cn/p/968/)
[字符串加密 | 使用unicorn engin还原Armariris字符串混淆](https://www.anquanke.com/post/id/181051#h3-8)

[安卓 so文件在linux下能调用么](https://www.baidu.com/s?wd=%E5%AE%89%E5%8D%93+so%E6%96%87%E4%BB%B6%E5%9C%A8linux%E4%B8%8B%E8%83%BD%E8%B0%83%E7%94%A8%E4%B9%88)

[OLLVM 之控制流平坦化源码学习](http://www.qfrost.com/LLVM/【LLVM】Flattening源码分析/)
[OLLVM 之全局变量间接访问源码学习](http://www.qfrost.com/LLVM/%E3%80%90LLVM%E3%80%91%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E9%97%B4%E6%8E%A5%E8%AE%BF%E9%97%AE%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/)
[OLLVM Pluto 之平坦化增强源码学习](http://www.qfrost.com/LLVM/【LLVM】FlatteningEnhanced/)
## LLVM使用
[LLVM入坑笔记(一):正式开始前的准备](https://blog.t0hka.top/archives/llvm入坑笔记一正式开始前的准备)
[LLVM入坑笔记(二):LLVM Pass初探](https://blog.t0hka.top/archives/llvm入坑二llvmpass初探)
[2023安卓逆向工具篇（windows下ollvm的使用）-哔哩哔哩](https://www.bilibili.com/video/BV1824y1s7tP)

## 脚本 
https://github.com/mFallW1nd/deflat

## ollvm字符串加密
// 或者直接用修复后的内存so?
ida 加载
```c
int __fastcall JNI_OnLoad(JavaVM *a1)  // 按Y 下拉菜单改为JavaVM*
...
result = ((int (*)(void))(*a1) -> GetEnv)() // 右击GetEnv Force call type
...
((void (*)(void))(*v4)->FindClass()) // 右击 FindClass Force call type
((void (*)(void))(*v4)->RegisterNatives()) // 右击 RegisterNatives Force call type
```
1. String 查看字符串有无加密
2. 010 Editor打开。查看 struct section_header_table 的.data段。数据有无加密


解密办法. dump内存
```sh
adb shell
su
ps | grep cn.xiaohcuankeji.tieba # 得到pid

cat /proc/13598/maps | grep libnet
# u0_a67 13598 194 1057208 99148 fffffff 400446e0 S cn. xiaochuanke ji. tieba

cat /proc/13598/maps | grep libnet
40250000-40255000 r-xp 00000000 b3:15 38718 /system/lib/libnetutils.so
40255000-40256000 r--p 00004000 b3:15 38718 /system/1ib/libnetutils.so
40256000-40257000 rw-p 00005000 b3:15 38718 /system/lib/libnetutils.so
79abf000-79c2b000 r-xp 00000000 b3:17 325814 /data/app-lib/cn.xiaochuankeji.tieba-1/libnet_crypto.so
79c2b000-79c3c000 r--p 0016b000 b3:17 325814 /data/app-lib/cn.xiaochuankeji.tieba-1/libnet_crypto.so
79c3c000-79c3e000 rw-p 0017c000 b3:17 325814 /data/app-lib/cn.xiaochuankeji.tieba-1/libnet_crypto.so
.data 是存放于rw-p的 可读写区域的。

# 79c3c000 = 2042871808 , 8192 = 79c3e000 - 79c3c000
dd if=/proc/13598/mem of=/data/local/tmp/dump.so skip=2042871808 bs=1 count=8192

chmod 777 /data/local/tmp/dump.so
exit

adb pull /data/local/tmp/dump.so
```
原文件和dump出来的文件对比。

![](https://s2.loli.net/2022/09/09/REcOHixydSmvjFo.jpg)

用010 Editor把dump的字符串部分替换到libnet_crypto.so中 解决字符串加密问题。

## ollvm控制流程平坦化
## ollvm指令替换
## ollvm虚假控制流

## 环境配置
```sh
git clone -b llvm-4.0 https://github.com/obfuscator-llvm/obfuscator.git --depth=1
# https://github.com/heroims/obfuscator/tree/llvm-4.0
mkdir build  
cd build  
cmake -DCMAKE_BUILD_TYPE=Release ../obfuscator/
cmake -DCMAKE_BUILD_TYPE=Release ../obfuscator/
cmake -DCMAKE_BUILD_TYPE=Release -DLLVM_INCLUDE_TESTS=OFF ../obfuscator/    # 有错用这条
make -j7
编译好的二进制程序都存在在build/bin目录下
```
docker 版
https://www.bilibili.com/read/cv13148903/
https://blog.csdn.net/qq_37507251/article/details/118530954